
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#2196f3">
  <script src="../_static/javascripts/modernizr.js"></script>
  
    <script async src="../_static/cookieconsent.min.js"></script>
    <script>
        window.addEventListener("load", function(){
        window.cookieconsent.initialise({
            "palette": {
            "popup": {
                "background": "#f0f0f0",
                "text": "#999"
            },
            "button": {
                "text": "#fff",
                "background": "#009688"
            }
            },
            "theme": "classic"
        })});
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q6ZE82CNZB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-Q6ZE82CNZB');
    </script>
  
    <link rel="apple-touch-icon" href="../_static/images/apple-icon-152x152.png"/>
  
  
    <title>T001 · Compound data acquisition (ChEMBL) &#8212; TeachOpenCADD 0 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="T002 · Molecular filtering: ADME and lead-likeness criteria" href="T002_compound_adme.html" />
    <link rel="prev" title="Talktorials by collection" href="../talktorials.html" />
  
    <link rel="apple-touch-icon" href="../_static/images/apple-icon-152x152.png"/>
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=teal data-md-color-accent=cyan>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#talktorials/T001_query_chembl" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="TeachOpenCADD 0 documentation"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">TeachOpenCADD (WIP 🚧)</span>
          <span class="md-header-nav__topic"> T001 · Compound data acquisition (ChEMBL) </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/volkamerlab/teachopencadd/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    TeachOpenCADD
  </div>
</a>
          </div>
        </div>
      
      
    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../talktorials.html" class="md-tabs__link">Our talktorials</a></li>
            
            <li class="md-tabs__item"><a href="../installing.html" class="md-tabs__link">Run locally</a></li>
            
            <li class="md-tabs__item"><a href="../contribute.html" class="md-tabs__link">Contribute</a></li>
          <li class="md-tabs__item"><a href="../talktorials.html" class="md-tabs__link">Talktorials by collection</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="TeachOpenCADD 0 documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    <a href="../index.html"
       title="TeachOpenCADD 0 documentation">TeachOpenCADD (WIP 🚧)</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/volkamerlab/teachopencadd/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    TeachOpenCADD
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Our talktorials</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html" class="md-nav__link">Talktorials by collection</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../all_talktorials.html" class="md-nav__link">Complete list of talktorials</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> T001 · Compound data acquisition (ChEMBL) </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">T001 · Compound data acquisition (ChEMBL)</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#talktorials-t001-query-chembl--page-root" class="md-nav__link">T001 · Compound data acquisition (ChEMBL)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Aim-of-this-talktorial" class="md-nav__link">Aim of this talktorial</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Contents-in-Theory" class="md-nav__link">Contents in <em>Theory</em></a>
        </li>
        <li class="md-nav__item"><a href="#Contents-in-Practical" class="md-nav__link">Contents in <em>Practical</em></a>
        </li>
        <li class="md-nav__item"><a href="#References" class="md-nav__link">References</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Theory" class="md-nav__link">Theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#ChEMBL-database" class="md-nav__link">ChEMBL database</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#ChEMBL-web-services" class="md-nav__link">ChEMBL web services</a>
        </li>
        <li class="md-nav__item"><a href="#ChEMBL-webresource-client" class="md-nav__link">ChEMBL webresource client</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Compound-activity-measures" class="md-nav__link">Compound activity measures</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#IC50-measure" class="md-nav__link">IC50 measure</a>
        </li>
        <li class="md-nav__item"><a href="#pIC50-value" class="md-nav__link">pIC50 value</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Practical" class="md-nav__link">Practical</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Connect-to-ChEMBL-database" class="md-nav__link">Connect to ChEMBL database</a>
        </li>
        <li class="md-nav__item"><a href="#Get-target-data-(EGFR-kinase)" class="md-nav__link">Get target data (EGFR kinase)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Fetch-target-data-from-ChEMBL" class="md-nav__link">Fetch target data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Download-target-data-from-ChEMBL" class="md-nav__link">Download target data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Select-target-(target-ChEMBL-ID)" class="md-nav__link">Select target (target ChEMBL ID)</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Get-bioactivity-data" class="md-nav__link">Get bioactivity data</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Fetch-bioactivity-data-for-the-target-from-ChEMBL" class="md-nav__link">Fetch bioactivity data for the target from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Download-bioactivity-data-from-ChEMBL" class="md-nav__link">Download bioactivity data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Freeze-bioactivity-data-to-ChEMBL-27" class="md-nav__link">Freeze bioactivity data to ChEMBL 27</a>
        </li>
        <li class="md-nav__item"><a href="#Preprocess-and-filter-bioactivity-data" class="md-nav__link">Preprocess and filter bioactivity data</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Get-compound-data" class="md-nav__link">Get compound data</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Fetch-compound-data-from-ChEMBL" class="md-nav__link">Fetch compound data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Download-compound-data-from-ChEMBL" class="md-nav__link">Download compound data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Preprocess-and-filter-compound-data" class="md-nav__link">Preprocess and filter compound data</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Output-(bioactivity-compound)-data" class="md-nav__link">Output (bioactivity-compound) data</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Merge-both-datasets" class="md-nav__link">Merge both datasets</a>
        </li>
        <li class="md-nav__item"><a href="#Add-pIC50-values" class="md-nav__link">Add pIC50 values</a>
        </li>
        <li class="md-nav__item"><a href="#Draw-compound-data" class="md-nav__link">Draw compound data</a>
        </li>
        <li class="md-nav__item"><a href="#Write-output-data-to-file" class="md-nav__link">Write output data to file</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Discussion" class="md-nav__link">Discussion</a>
        </li>
        <li class="md-nav__item"><a href="#Quiz" class="md-nav__link">Quiz</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/talktorials/T001_query_chembl.nblink.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T002_compound_adme.html" class="md-nav__link">T002 · Molecular filtering: ADME and lead-likeness criteria</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T003_compound_unwanted_substructures.html" class="md-nav__link">T003 · Molecular filtering: unwanted substructures</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T004_compound_similarity.html" class="md-nav__link">T004 · Ligand-based screening: compound similarity</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T005_compound_clustering.html" class="md-nav__link">T005 · Compound clustering</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T006_compound_maximum_common_substructures.html" class="md-nav__link">T006 · Maximum common substructure</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T007_compound_activity_machine_learning.html" class="md-nav__link">T007 · Ligand-based screening: machine learning</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T008_query_pdb.html" class="md-nav__link">T008 · Protein data acquisition: Protein Data Bank (PDB)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T009_compound_ensemble_pharmacophores.html" class="md-nav__link">T009 · Ligand-based pharmacophores</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T010_binding_site_comparison.html" class="md-nav__link">T010 · Binding site similarity and off-target prediction</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Run locally</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installing.html" class="md-nav__link">Installing</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Contributors</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../contribute.html" class="md-nav__link">For contributors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../api.html" class="md-nav__link">API Documentation</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#talktorials-t001-query-chembl--page-root" class="md-nav__link">T001 · Compound data acquisition (ChEMBL)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Aim-of-this-talktorial" class="md-nav__link">Aim of this talktorial</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Contents-in-Theory" class="md-nav__link">Contents in <em>Theory</em></a>
        </li>
        <li class="md-nav__item"><a href="#Contents-in-Practical" class="md-nav__link">Contents in <em>Practical</em></a>
        </li>
        <li class="md-nav__item"><a href="#References" class="md-nav__link">References</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Theory" class="md-nav__link">Theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#ChEMBL-database" class="md-nav__link">ChEMBL database</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#ChEMBL-web-services" class="md-nav__link">ChEMBL web services</a>
        </li>
        <li class="md-nav__item"><a href="#ChEMBL-webresource-client" class="md-nav__link">ChEMBL webresource client</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Compound-activity-measures" class="md-nav__link">Compound activity measures</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#IC50-measure" class="md-nav__link">IC50 measure</a>
        </li>
        <li class="md-nav__item"><a href="#pIC50-value" class="md-nav__link">pIC50 value</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Practical" class="md-nav__link">Practical</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Connect-to-ChEMBL-database" class="md-nav__link">Connect to ChEMBL database</a>
        </li>
        <li class="md-nav__item"><a href="#Get-target-data-(EGFR-kinase)" class="md-nav__link">Get target data (EGFR kinase)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Fetch-target-data-from-ChEMBL" class="md-nav__link">Fetch target data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Download-target-data-from-ChEMBL" class="md-nav__link">Download target data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Select-target-(target-ChEMBL-ID)" class="md-nav__link">Select target (target ChEMBL ID)</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Get-bioactivity-data" class="md-nav__link">Get bioactivity data</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Fetch-bioactivity-data-for-the-target-from-ChEMBL" class="md-nav__link">Fetch bioactivity data for the target from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Download-bioactivity-data-from-ChEMBL" class="md-nav__link">Download bioactivity data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Freeze-bioactivity-data-to-ChEMBL-27" class="md-nav__link">Freeze bioactivity data to ChEMBL 27</a>
        </li>
        <li class="md-nav__item"><a href="#Preprocess-and-filter-bioactivity-data" class="md-nav__link">Preprocess and filter bioactivity data</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Get-compound-data" class="md-nav__link">Get compound data</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Fetch-compound-data-from-ChEMBL" class="md-nav__link">Fetch compound data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Download-compound-data-from-ChEMBL" class="md-nav__link">Download compound data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Preprocess-and-filter-compound-data" class="md-nav__link">Preprocess and filter compound data</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Output-(bioactivity-compound)-data" class="md-nav__link">Output (bioactivity-compound) data</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Merge-both-datasets" class="md-nav__link">Merge both datasets</a>
        </li>
        <li class="md-nav__item"><a href="#Add-pIC50-values" class="md-nav__link">Add pIC50 values</a>
        </li>
        <li class="md-nav__item"><a href="#Draw-compound-data" class="md-nav__link">Draw compound data</a>
        </li>
        <li class="md-nav__item"><a href="#Write-output-data-to-file" class="md-nav__link">Write output data to file</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Discussion" class="md-nav__link">Discussion</a>
        </li>
        <li class="md-nav__item"><a href="#Quiz" class="md-nav__link">Quiz</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/talktorials/T001_query_chembl.nblink.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>

<h1 id="talktorials-t001-query-chembl--page-root">T001 · Compound data acquisition (ChEMBL)<a class="headerlink" href="#talktorials-t001-query-chembl--page-root" title="Permalink to this headline">¶</a></h1>
<p>Authors:</p>
<ul class="simple">
<li><p>Svetlana Leng, CADD seminar 2017, Volkamer lab, Charité/FU Berlin</p></li>
<li><p>Paula Junge, CADD seminar 2018, Volkamer lab, Charité/FU Berlin</p></li>
<li><p>Dominique Sydow, 2019-2020, <a class="reference external" href="https://volkamerlab.org/">Volkamer lab, Charité</a></p></li>
<li><p>Andrea Volkamer, 2020, <a class="reference external" href="https://volkamerlab.org/">Volkamer lab, Charité</a></p></li>
<li><p>Yonghui Chen, 2020, <a class="reference external" href="https://volkamerlab.org/">Volkamer lab, Charité</a></p></li>
</ul>
<p><strong>Talktorial T001</strong>: This talktorial is part of the TeachOpenCADD pipeline described in the <a class="reference external" href="https://jcheminf.biomedcentral.com/articles/10.1186/s13321-019-0351-x">first TeachOpenCADD paper</a>, comprising of talktorials T001-T010.</p>

<h2 id="Aim-of-this-talktorial">Aim of this talktorial<a class="headerlink" href="#Aim-of-this-talktorial" title="Permalink to this headline">¶</a></h2>
<p>In this notebook, we will learn more about the ChEMBL database and how to extract data from ChEMBL, i.e. (compound, activity data) pairs for a target of interest. These data sets can be used for many cheminformatics tasks, such as similarity search, clustering or machine learning.</p>
<p>Our work here will include finding compounds which were tested against a certain target and filtering available bioactivity data.</p>

<h3 id="Contents-in-Theory">Contents in <em>Theory</em><a class="headerlink" href="#Contents-in-Theory" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>ChEMBL database</p>
<ul>
<li><p>ChEMBL web services</p></li>
<li><p>ChEMBL webresource client</p></li>
</ul>
</li>
<li><p>Compound activity measures</p>
<ul>
<li><p>IC50 measure</p></li>
<li><p>pIC50 value</p></li>
</ul>
</li>
</ul>


<h3 id="Contents-in-Practical">Contents in <em>Practical</em><a class="headerlink" href="#Contents-in-Practical" title="Permalink to this headline">¶</a></h3>
<p><strong>Goal: Get a list of compounds with bioactivity data for a given target</strong></p>
<ul class="simple">
<li><p>Connect to ChEMBL database</p></li>
<li><p>Get target data (example: EGFR kinase)</p>
<ul>
<li><p>Fetch and download target data</p></li>
<li><p>Select target ChEMBL ID</p></li>
</ul>
</li>
<li><p>Get bioactivity data</p>
<ul>
<li><p>Fetch and download bioactivity data for target</p></li>
<li><p>Preprocess and filter bioactivities</p></li>
</ul>
</li>
<li><p>Get compound data</p>
<ul>
<li><p>Fetch and download compound data</p></li>
<li><p>Preprocess and filter compound data</p></li>
</ul>
</li>
<li><p>Output bioactivity-compound data</p>
<ul>
<li><p>Merge bioactivity and compound data, and add pIC50 values</p></li>
<li><p>Draw molecules with highest pIC50</p></li>
<li><p>Write output file</p></li>
</ul>
</li>
</ul>


<h3 id="References">References<a class="headerlink" href="#References" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>ChEMBL bioactivity database: <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5210557/">Gaulton et al., Nucleic Acids Res. (2017), 45(Database issue), D945–D954</a></p></li>
<li><p>ChEMBL web services: <a class="reference external" href="https://academic.oup.com/nar/article/43/W1/W612/2467881">Davies et al., Nucleic Acids Res. (2015), 43, 612-620</a></p></li>
<li><p><a class="reference external" href="https://www.ebi.ac.uk/chembl/">ChEMBL web-interface</a></p></li>
<li><p>GitHub <a class="reference external" href="https://github.com/chembl/chembl_webresource_client">ChEMBL webrescource client</a></p></li>
<li><p><a class="reference external" href="https://github.com/chembl/mychembl/blob/master/ipython_notebooks/09_myChEMBL_web_services.ipynb">myChEMBL web services version 2.x</a></p></li>
<li><p>The EBI RDF platform: <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/24413672">Jupp et al., Bioinformatics (2014), 30(9), 1338-9</a></p></li>
<li><p>Info on half maximal inhibitory concentration: <a class="reference external" href="https://en.wikipedia.org/wiki/IC50">(p)IC50</a></p></li>
<li><p><a class="reference external" href="https://www.uniprot.org/">UniProt website</a></p></li>
</ul>



<h2 id="Theory">Theory<a class="headerlink" href="#Theory" title="Permalink to this headline">¶</a></h2>

<h3 id="ChEMBL-database">ChEMBL database<a class="headerlink" href="#ChEMBL-database" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>“ChEMBL is a manually curated database of bioactive molecules with drug-like properties. It brings together chemical, bioactivity and genomic data to aid the translation of genomic information into effective new drugs.” (<a class="reference external" href="https://www.ebi.ac.uk/chembl/">ChEMBL website</a>)</p>
</div></blockquote>
<ul class="simple">
<li><p>Open large-scale bioactivity database</p></li>
<li><p><strong>Current data content (as of 09.2020, ChEMBL 27):</strong></p>
<ul>
<li><p>&gt;1.9 million distinct compounds</p></li>
<li><p>&gt;16 million activity values</p></li>
<li><p>Assays are mapped to ~13,000 targets</p></li>
</ul>
</li>
<li><p><strong>Data sources</strong> include scientific literature, PubChem bioassays, Drugs for Neglected Diseases Initiative (DNDi), BindingDB database, …</p></li>
<li><p>ChEMBL data can be accessed via a <a class="reference external" href="https://www.ebi.ac.uk/chembl/">web-interface</a>, the <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/24413672">EBI-RDF platform</a> and the <a class="reference external" href="https://github.com/chembl/mychembl/blob/master/ipython_notebooks/09_myChEMBL_web_services.ipynb">ChEMBL web services</a></p></li>
</ul>

<h4 id="ChEMBL-web-services">ChEMBL web services<a class="headerlink" href="#ChEMBL-web-services" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>RESTful web service</p></li>
<li><p>ChEMBL web service version 2.x resource schema:</p></li>
</ul>
<img alt="ChEMBL web service schema" src="../_images/chembl_webservices_schema_diagram.jpg"/>
<p><em>Figure 1:</em> “<a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4489243/figure/F2/">ChEMBL web service schema diagram</a>. The oval shapes represent ChEMBL web service resources and the line between two resources indicates that they share a common attribute. The arrow direction shows where the primary information about a resource type can be found. A dashed line indicates the relationship between two resources behaves differently. For example, the <code class="docutils literal notranslate"><span class="pre">Image</span></code> resource provides a graphical based
representation of a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code>.” Figure and description taken from: <a class="reference external" href="https://academic.oup.com/nar/article/43/W1/W612/2467881">Nucleic Acids Res. (2015), 43, 612-620</a>.</p>


<h4 id="ChEMBL-webresource-client">ChEMBL webresource client<a class="headerlink" href="#ChEMBL-webresource-client" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Python client library for accessing ChEMBL data</p></li>
<li><p>Handles interaction with the HTTPS protocol</p></li>
<li><p>Lazy evaluation of results -&gt; reduced number of network requests</p></li>
</ul>



<h3 id="Compound-activity-measures">Compound activity measures<a class="headerlink" href="#Compound-activity-measures" title="Permalink to this headline">¶</a></h3>

<h4 id="IC50-measure">IC50 measure<a class="headerlink" href="#IC50-measure" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/IC50">Half maximal inhibitory concentration</a></p></li>
<li><p>Indicates how much of a particular drug or other substance is needed to inhibit a given biological process by half</p></li>
</ul>
<img alt="Wiki_Example_IC50_curve_demonstrating_visually_how_IC50_is_derived" src="../_images/Wiki_Example_IC50_curve_demonstrating_visually_how_IC50_is_derived.png"/>
<p><em>Figure 2:</em> Visual demonstration of how to derive an IC50 value: (i) Arrange inhibition data on y-axis and log(concentration) on x-axis. (ii) Identify maximum and minimum inhibition. (iii) The IC50 is the concentration at which the curve passes through the 50% inhibition level. Figure <a class="reference external" href="https://en.wikipedia.org/wiki/IC50#/media/File:Example_IC50_curve_demonstrating_visually_how_IC50_is_derived.png">“Example IC50 curve demonstrating visually how IC50 is derived”</a> by JesseAlanGordon is licensed
under <a class="reference external" href="https://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0</a>.</p>


<h4 id="pIC50-value">pIC50 value<a class="headerlink" href="#pIC50-value" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>To facilitate the comparison of IC50 values, which have a large value range and are given in different units (M, nM, …), often pIC50 values are used</p></li>
<li><p>The pIC50 is the negative log of the IC50 value when converted to molar units: $ pIC_{50} = -log_{10}(IC_{50}) $, where $ IC_{50}$ is specified in units of M</p></li>
<li><p>Higher pIC50 values indicate exponentially greater potency of the drug</p></li>
<li><p>Note that the conversion can be adapted to the respective IC50 unit, e.g. for nM: $pIC_{50} = -log_{10}(IC_{50}*10^{-9})= 9-log_{10}(IC_{50}) $</p></li>
</ul>
<p>Other activity measures:</p>
<p>Besides, IC50 and pIC50, other bioactivity measures are used, such as the equilibrium constant <a class="reference external" href="https://en.wikipedia.org/wiki/Equilibrium_constant">KI</a> and the half maximal effective concentration <a class="reference external" href="https://en.wikipedia.org/wiki/EC50">EC50</a>.</p>




<h2 id="Practical">Practical<a class="headerlink" href="#Practical" title="Permalink to this headline">¶</a></h2>
<p>In the following, we want to download all molecules that have been tested against our target of interest, the <strong>epidermal growth factor receptor</strong> (<a class="reference external" href="https://www.uniprot.org/uniprot/P00533">EGFR</a>) kinase.</p>

<h3 id="Connect-to-ChEMBL-database">Connect to ChEMBL database<a class="headerlink" href="#Connect-to-ChEMBL-database" title="Permalink to this headline">¶</a></h3>
<p>First, the ChEMBL webresource client as well as other python libraries are imported.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>
<span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">PandasTools</span>
<span class="kn">from</span> <span class="nn">chembl_webresource_client.new_client</span> <span class="kn">import</span> <span class="n">new_client</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">HERE</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">_dh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">DATA</span> <span class="o">=</span> <span class="n">HERE</span> <span class="o">/</span> <span class="s2">"data"</span>
</pre></div>
</div>
</div>
<p>Next, we create resource objects for API access.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">targets_api</span> <span class="o">=</span> <span class="n">new_client</span><span class="o">.</span><span class="n">target</span>
<span class="n">compounds_api</span> <span class="o">=</span> <span class="n">new_client</span><span class="o">.</span><span class="n">molecule</span>
<span class="n">bioactivities_api</span> <span class="o">=</span> <span class="n">new_client</span><span class="o">.</span><span class="n">activity</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">type</span><span class="p">(</span><span class="n">targets_api</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
chembl_webresource_client.query_set.QuerySet
</pre></div></div>
</div>


<h3 id="Get-target-data-(EGFR-kinase)">Get target data (EGFR kinase)<a class="headerlink" href="#Get-target-data-(EGFR-kinase)" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Get UniProt ID of the target of interest (EGFR kinase: <a class="reference external" href="http://www.uniprot.org/uniprot/P00533">P00533</a>) from <a class="reference external" href="https://www.uniprot.org/">UniProt website</a></p></li>
<li><p>Use UniProt ID to get target information</p></li>
</ul>
<p>Select a different UniProt ID, if you are interested in another target.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">uniprot_id</span> <span class="o">=</span> <span class="s2">"P00533"</span>
</pre></div>
</div>
</div>

<h4 id="Fetch-target-data-from-ChEMBL">Fetch target data from ChEMBL<a class="headerlink" href="#Fetch-target-data-from-ChEMBL" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Get target information from ChEMBL but restrict it to specified values only</span>
<span class="n">targets</span> <span class="o">=</span> <span class="n">targets_api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_components__accession</span><span class="o">=</span><span class="n">uniprot_id</span><span class="p">)</span><span class="o">.</span><span class="n">only</span><span class="p">(</span>
    <span class="s2">"target_chembl_id"</span><span class="p">,</span> <span class="s2">"organism"</span><span class="p">,</span> <span class="s2">"pref_name"</span><span class="p">,</span> <span class="s2">"target_type"</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'The type of the targets is "</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span><span class="si">}</span><span class="s1">"'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The type of the targets is "&lt;class 'chembl_webresource_client.query_set.QuerySet'&gt;"
</pre></div></div>
</div>


<h4 id="Download-target-data-from-ChEMBL">Download target data from ChEMBL<a class="headerlink" href="#Download-target-data-from-ChEMBL" title="Permalink to this headline">¶</a></h4>
<p>The results of the query are stored in <code class="docutils literal notranslate"><span class="pre">targets</span></code>, a <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code>, i.e. the results are not fetched from ChEMBL until we ask for it (here using <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.from_records</span></code>).</p>
<p>More information about the <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> datatype:</p>
<blockquote>
<div><p>QuerySets are lazy – the act of creating a QuerySet does not involve any database activity. You can stack filters together all day long, and Django will actually not run the query until the QuerySet is evaluated. (<a class="reference external" href="https://docs.djangoproject.com/en/3.0/topics/db/queries/#querysets-are-lazy">querysets-are-lazy</a>)</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">targets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
<span class="n">targets</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>organism</th>
<th>pref_name</th>
<th>target_chembl_id</th>
<th>target_type</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Homo sapiens</td>
<td>Epidermal growth factor receptor erbB1</td>
<td>CHEMBL203</td>
<td>SINGLE PROTEIN</td>
</tr>
<tr>
<th>1</th>
<td>Homo sapiens</td>
<td>Epidermal growth factor receptor erbB1</td>
<td>CHEMBL203</td>
<td>SINGLE PROTEIN</td>
</tr>
<tr>
<th>2</th>
<td>Homo sapiens</td>
<td>Epidermal growth factor receptor and ErbB2 (HE...</td>
<td>CHEMBL2111431</td>
<td>PROTEIN FAMILY</td>
</tr>
<tr>
<th>3</th>
<td>Homo sapiens</td>
<td>Epidermal growth factor receptor</td>
<td>CHEMBL2363049</td>
<td>PROTEIN FAMILY</td>
</tr>
<tr>
<th>4</th>
<td>Homo sapiens</td>
<td>MER intracellular domain/EGFR extracellular do...</td>
<td>CHEMBL3137284</td>
<td>CHIMERIC PROTEIN</td>
</tr>
</tbody>
</table>
</div></div>
</div>


<h4 id="Select-target-(target-ChEMBL-ID)">Select target (target ChEMBL ID)<a class="headerlink" href="#Select-target-(target-ChEMBL-ID)" title="Permalink to this headline">¶</a></h4>
<p>After checking the entries, we select the first entry as our target of interest:</p>
<p><code class="docutils literal notranslate"><span class="pre">CHEMBL203</span></code>: It is a single protein and represents the human Epidermal growth factor receptor (EGFR, also named erbB1)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">target</span> <span class="o">=</span> <span class="n">targets</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">target</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
organism                                      Homo sapiens
pref_name           Epidermal growth factor receptor erbB1
target_chembl_id                                 CHEMBL203
target_type                                 SINGLE PROTEIN
Name: 0, dtype: object
</pre></div></div>
</div>
<p>Save selected ChEMBL ID.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chembl_id</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">target_chembl_id</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The target ChEMBL ID is </span><span class="si">{</span><span class="n">chembl_id</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The target ChEMBL ID is CHEMBL203
</pre></div></div>
</div>



<h3 id="Get-bioactivity-data">Get bioactivity data<a class="headerlink" href="#Get-bioactivity-data" title="Permalink to this headline">¶</a></h3>
<p>Now, we want to query bioactivity data for the target of interest.</p>

<h4 id="Fetch-bioactivity-data-for-the-target-from-ChEMBL">Fetch bioactivity data for the target from ChEMBL<a class="headerlink" href="#Fetch-bioactivity-data-for-the-target-from-ChEMBL" title="Permalink to this headline">¶</a></h4>
<p>In this step, we fetch the bioactivity data and filter it to only consider</p>
<ul class="simple">
<li><p>human proteins,</p></li>
<li><p>bioactivity type IC50,</p></li>
<li><p>exact measurements (relation <code class="docutils literal notranslate"><span class="pre">'='</span></code>), and</p></li>
<li><p>binding data (assay type <code class="docutils literal notranslate"><span class="pre">'B'</span></code>).</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bioactivities</span> <span class="o">=</span> <span class="n">bioactivities_api</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">target_chembl_id</span><span class="o">=</span><span class="n">chembl_id</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"IC50"</span><span class="p">,</span> <span class="n">relation</span><span class="o">=</span><span class="s2">"="</span><span class="p">,</span> <span class="n">assay_type</span><span class="o">=</span><span class="s2">"B"</span>
<span class="p">)</span><span class="o">.</span><span class="n">only</span><span class="p">(</span>
    <span class="s2">"activity_id"</span><span class="p">,</span>
    <span class="s2">"assay_chembl_id"</span><span class="p">,</span>
    <span class="s2">"assay_description"</span><span class="p">,</span>
    <span class="s2">"assay_type"</span><span class="p">,</span>
    <span class="s2">"molecule_chembl_id"</span><span class="p">,</span>
    <span class="s2">"type"</span><span class="p">,</span>
    <span class="s2">"standard_units"</span><span class="p">,</span>
    <span class="s2">"relation"</span><span class="p">,</span>
    <span class="s2">"standard_value"</span><span class="p">,</span>
    <span class="s2">"target_chembl_id"</span><span class="p">,</span>
    <span class="s2">"target_organism"</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Length and type of bioactivities object: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">bioactivities</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">bioactivities</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Length and type of bioactivities object: 7177, &lt;class 'chembl_webresource_client.query_set.QuerySet'&gt;
</pre></div></div>
</div>
<p>Our bioactivity set contains 7177 entries, each holding the following information.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Length and type of first element: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">bioactivities</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">bioactivities</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">bioactivities</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Length and type of first element: 13, &lt;class 'dict'&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{'activity_id': 32260,
 'assay_chembl_id': 'CHEMBL674637',
 'assay_description': 'Inhibitory activity towards tyrosine phosphorylation for the epidermal growth factor-receptor kinase',
 'assay_type': 'B',
 'molecule_chembl_id': 'CHEMBL68920',
 'relation': '=',
 'standard_units': 'nM',
 'standard_value': '41.0',
 'target_chembl_id': 'CHEMBL203',
 'target_organism': 'Homo sapiens',
 'type': 'IC50',
 'units': 'uM',
 'value': '0.041'}
</pre></div></div>
</div>


<h4 id="Download-bioactivity-data-from-ChEMBL">Download bioactivity data from ChEMBL<a class="headerlink" href="#Download-bioactivity-data-from-ChEMBL" title="Permalink to this headline">¶</a></h4>
<p>Finally, we download the <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> in the form of a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<blockquote>
<div><p><strong>Note</strong>: This step should not take more than 2 minutes, if so try to rerun all cells starting from <em>“Fetch bioactivity data for the target from ChEMBL”</em> or read this message below:</p>
</div></blockquote>
<details><summary><p>Load a local version of the data (in case you encounter any problems while fetching the data)</p>
</summary><p>If you experience difficulties to query the ChEMBL database, we also provide the resulting dataframe you will construct in the cell below. If you want to use the saved version, use the following code instead to obtain <code class="docutils literal notranslate"><span class="pre">bioactivities_df</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># replace first line in cell below with this other line</span>
<span class="n">bioactivities_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DATA</span> <span class="o">/</span> <span class="s2">"EGFR_compounds_CHEMBL27.csv.zip"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</details><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bioactivities_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">bioactivities</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">bioactivities_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (7178, 13)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>activity_id</th>
<th>assay_chembl_id</th>
<th>assay_description</th>
<th>assay_type</th>
<th>molecule_chembl_id</th>
<th>relation</th>
<th>standard_units</th>
<th>standard_value</th>
<th>target_chembl_id</th>
<th>target_organism</th>
<th>type</th>
<th>units</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>32260</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL68920</td>
<td>=</td>
<td>nM</td>
<td>41.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
<td>uM</td>
<td>0.041</td>
</tr>
<tr>
<th>1</th>
<td>32260</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL68920</td>
<td>=</td>
<td>nM</td>
<td>41.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
<td>uM</td>
<td>0.041</td>
</tr>
<tr>
<th>2</th>
<td>32267</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL69960</td>
<td>=</td>
<td>nM</td>
<td>170.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
<td>uM</td>
<td>0.17</td>
</tr>
<tr>
<th>3</th>
<td>32680</td>
<td>CHEMBL677833</td>
<td>In vitro inhibition of Epidermal growth factor...</td>
<td>B</td>
<td>CHEMBL137635</td>
<td>=</td>
<td>nM</td>
<td>9300.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
<td>uM</td>
<td>9.3</td>
</tr>
<tr>
<th>4</th>
<td>32770</td>
<td>CHEMBL674643</td>
<td>Inhibitory concentration of EGF dependent auto...</td>
<td>B</td>
<td>CHEMBL306988</td>
<td>=</td>
<td>nM</td>
<td>500000.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
<td>uM</td>
<td>500.0</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<p>Note, that we have columns for <code class="docutils literal notranslate"><span class="pre">standard_units</span></code>/<code class="docutils literal notranslate"><span class="pre">units</span></code> and <code class="docutils literal notranslate"><span class="pre">standard_values</span></code>/<code class="docutils literal notranslate"><span class="pre">values</span></code> - in the following we will use the standardized columns (standardization by ChEMBL). Thus, we drop the other two columns.</p>
<p>If we used the <code class="docutils literal notranslate"><span class="pre">units</span></code> and <code class="docutils literal notranslate"><span class="pre">values</span></code> columns, we would need to convert all values with many different units to nM:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bioactivities_df</span><span class="p">[</span><span class="s2">"units"</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array(['uM', 'nM', 'pM', 'M', "10'3 uM", "10'1 ug/ml", 'ug ml-1',
       "10'-1microM", "10'1 uM", "10'-1 ug/ml", "10'-2 ug/ml", "10'2 uM",
       "10'-3 ug/ml", "10'-2microM", '/uM', "10'-6g/ml", 'mM', 'umol/L',
       'nmol/L', "10'-10M"], dtype=object)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">"units"</span><span class="p">,</span> <span class="s2">"value"</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">bioactivities_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>activity_id</th>
<th>assay_chembl_id</th>
<th>assay_description</th>
<th>assay_type</th>
<th>molecule_chembl_id</th>
<th>relation</th>
<th>standard_units</th>
<th>standard_value</th>
<th>target_chembl_id</th>
<th>target_organism</th>
<th>type</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>32260</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL68920</td>
<td>=</td>
<td>nM</td>
<td>41.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>1</th>
<td>32260</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL68920</td>
<td>=</td>
<td>nM</td>
<td>41.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>2</th>
<td>32267</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL69960</td>
<td>=</td>
<td>nM</td>
<td>170.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>3</th>
<td>32680</td>
<td>CHEMBL677833</td>
<td>In vitro inhibition of Epidermal growth factor...</td>
<td>B</td>
<td>CHEMBL137635</td>
<td>=</td>
<td>nM</td>
<td>9300.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>4</th>
<td>32770</td>
<td>CHEMBL674643</td>
<td>Inhibitory concentration of EGF dependent auto...</td>
<td>B</td>
<td>CHEMBL306988</td>
<td>=</td>
<td>nM</td>
<td>500000.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
</tbody>
</table>
</div></div>
</div>


<h4 id="Freeze-bioactivity-data-to-ChEMBL-27">Freeze bioactivity data to ChEMBL 27<a class="headerlink" href="#Freeze-bioactivity-data-to-ChEMBL-27" title="Permalink to this headline">¶</a></h4>
<p>This is a technical step: Usually, we would continue to work with the dataset that we just downloaded (latest dataset).</p>
<p>However, here on the TeachOpenCADD platform, we prefer to freeze the dataset to a certain ChEMBL releases (i.e. <a class="reference external" href="http://doi.org/10.6019/CHEMBL.database.27">ChEMBL 27</a>), so that this talktorial and other talktorials downstream in our CADD pipeline do not change in the future (helping us to maintain the talktorials).</p>
<p>This cell will load bioactivity IDs in ChEMBL 27 release from file <code class="docutils literal notranslate"><span class="pre">data/chembl27_activities.npz.zip</span></code>. We have to uncompress it to a temporary file first, and then load it with <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
<p>If you are interested, you can check out how this file was generated in <code class="docutils literal notranslate"><span class="pre">data/all_chembl_activities.ipynb</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">ZipFile</span><span class="p">(</span><span class="n">DATA</span> <span class="o">/</span> <span class="s2">"chembl27_activities.npz.zip"</span><span class="p">)</span> <span class="k">as</span> <span class="n">z</span><span class="p">,</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdir</span><span class="p">:</span>
    <span class="n">z</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s2">"chembl27_activities.npz"</span><span class="p">,</span> <span class="n">tmpdir</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">)</span> <span class="o">/</span> <span class="s2">"chembl27_activities.npz"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">bioactivity_ids_chembl_27</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s2">"activities"</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of bioactivity values in full ChEMBL 27 release: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">bioactivity_ids_chembl_27</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of bioactivity values in full ChEMBL 27 release: 16066124
</pre></div></div>
</div>
<p>Keep only bioactivities with bioactivity IDs from the ChEMBL 27 release.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of bioactivities queried for EGFR in this notebook: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="c1"># Get the intersection between the current and the frozen ChEMBL version</span>
<span class="n">bioactivities_df</span> <span class="o">=</span> <span class="n">bioactivities_df</span><span class="p">[</span>
    <span class="n">bioactivities_df</span><span class="p">[</span><span class="s2">"activity_id"</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bioactivity_ids_chembl_27</span><span class="p">)</span>
<span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of bioactivities after ChEMBL 27 intersection: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of bioactivities queried for EGFR in this notebook: 7178
Number of bioactivities after ChEMBL 27 intersection: 7178
</pre></div></div>
</div>
<p>Note: If these numbers are the same, it means the latest ChEMBL release is still ChEMBL 27.</p>
<p>You can check out the current <a class="reference external" href="https://chembl.gitbook.io/chembl-interface-documentation/downloads">ChEMBL</a> release.</p>


<h4 id="Preprocess-and-filter-bioactivity-data">Preprocess and filter bioactivity data<a class="headerlink" href="#Preprocess-and-filter-bioactivity-data" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>Convert <code class="docutils literal notranslate"><span class="pre">standard_value</span></code>’s datatype from <code class="docutils literal notranslate"><span class="pre">object</span></code> to <code class="docutils literal notranslate"><span class="pre">float</span></code></p></li>
<li><p>Delete entries with missing values</p></li>
<li><p>Keep only entries with <code class="docutils literal notranslate"><span class="pre">standard_unit</span> <span class="pre">==</span> <span class="pre">nM</span></code></p></li>
<li><p>Delete duplicate molecules</p></li>
<li><p>Reset <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> index</p></li>
<li><p>Rename columns</p></li>
</ol>
<p><strong>1. Convert datatype of “standard_value” from “object” to “float”</strong></p>
<p>The field <code class="docutils literal notranslate"><span class="pre">standard_value</span></code> holds standardized (here IC50) values. In order to make these values usable in calculations later on, convert values to floats.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
activity_id            int64
assay_chembl_id       object
assay_description     object
assay_type            object
molecule_chembl_id    object
relation              object
standard_units        object
standard_value        object
target_chembl_id      object
target_organism       object
type                  object
dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bioactivities_df</span> <span class="o">=</span> <span class="n">bioactivities_df</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s2">"standard_value"</span><span class="p">:</span> <span class="s2">"float64"</span><span class="p">})</span>
<span class="n">bioactivities_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
activity_id             int64
assay_chembl_id        object
assay_description      object
assay_type             object
molecule_chembl_id     object
relation               object
standard_units         object
standard_value        float64
target_chembl_id       object
target_organism        object
type                   object
dtype: object
</pre></div></div>
</div>
<p><strong>2. Delete entries with missing values</strong></p>
<p>Use the parameter <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> to drop values in the current <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> directly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"any"</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (7177, 11)
</pre></div></div>
</div>
<p><strong>3. Keep only entries with “standard_unit == nM”</strong></p>
<p>We only want to keep bioactivity entries in <code class="docutils literal notranslate"><span class="pre">nM</span></code>, thus we remove all entries with other units.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Units in downloaded data: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="p">[</span><span class="s1">'standard_units'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">"Number of non-nM entries:</span><span class="se">\</span>
<span class="s2">    </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="p">[</span><span class="n">bioactivities_df</span><span class="p">[</span><span class="s1">'standard_units'</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">'nM'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Units in downloaded data: ['nM' 'ug.mL-1' '/uM']
Number of non-nM entries:    64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bioactivities_df</span> <span class="o">=</span> <span class="n">bioactivities_df</span><span class="p">[</span><span class="n">bioactivities_df</span><span class="p">[</span><span class="s2">"standard_units"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"nM"</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Units after filtering: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="p">[</span><span class="s1">'standard_units'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Units after filtering: ['nM']
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (7113, 11)
</pre></div></div>
</div>
<p><strong>4. Delete duplicate molecules</strong></p>
<p>Sometimes the same molecule (<code class="docutils literal notranslate"><span class="pre">molecule_chembl_id</span></code>) has been tested more than once, in this case, we only keep the first one.</p>
<p>Note other choices could be to keep the one with the best value or a mean value of all assay results for the respective compound.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s2">"molecule_chembl_id"</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s2">"first"</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (5451, 11)
</pre></div></div>
</div>
<p><strong>5. Reset “DataFrame” index</strong></p>
<p>Since we deleted some rows, but we want to iterate over the index later, we reset the index to be continuous.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">bioactivities_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>activity_id</th>
<th>assay_chembl_id</th>
<th>assay_description</th>
<th>assay_type</th>
<th>molecule_chembl_id</th>
<th>relation</th>
<th>standard_units</th>
<th>standard_value</th>
<th>target_chembl_id</th>
<th>target_organism</th>
<th>type</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>32260</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL68920</td>
<td>=</td>
<td>nM</td>
<td>41.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>1</th>
<td>32267</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL69960</td>
<td>=</td>
<td>nM</td>
<td>170.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>2</th>
<td>32680</td>
<td>CHEMBL677833</td>
<td>In vitro inhibition of Epidermal growth factor...</td>
<td>B</td>
<td>CHEMBL137635</td>
<td>=</td>
<td>nM</td>
<td>9300.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>3</th>
<td>32770</td>
<td>CHEMBL674643</td>
<td>Inhibitory concentration of EGF dependent auto...</td>
<td>B</td>
<td>CHEMBL306988</td>
<td>=</td>
<td>nM</td>
<td>500000.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>4</th>
<td>32772</td>
<td>CHEMBL674643</td>
<td>Inhibitory concentration of EGF dependent auto...</td>
<td>B</td>
<td>CHEMBL66879</td>
<td>=</td>
<td>nM</td>
<td>3000000.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<p><strong>6. Rename columns</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"standard_value"</span><span class="p">:</span> <span class="s2">"IC50"</span><span class="p">,</span> <span class="s2">"standard_units"</span><span class="p">:</span> <span class="s2">"units"</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">bioactivities_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>activity_id</th>
<th>assay_chembl_id</th>
<th>assay_description</th>
<th>assay_type</th>
<th>molecule_chembl_id</th>
<th>relation</th>
<th>units</th>
<th>IC50</th>
<th>target_chembl_id</th>
<th>target_organism</th>
<th>type</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>32260</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL68920</td>
<td>=</td>
<td>nM</td>
<td>41.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>1</th>
<td>32267</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL69960</td>
<td>=</td>
<td>nM</td>
<td>170.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>2</th>
<td>32680</td>
<td>CHEMBL677833</td>
<td>In vitro inhibition of Epidermal growth factor...</td>
<td>B</td>
<td>CHEMBL137635</td>
<td>=</td>
<td>nM</td>
<td>9300.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>3</th>
<td>32770</td>
<td>CHEMBL674643</td>
<td>Inhibitory concentration of EGF dependent auto...</td>
<td>B</td>
<td>CHEMBL306988</td>
<td>=</td>
<td>nM</td>
<td>500000.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>4</th>
<td>32772</td>
<td>CHEMBL674643</td>
<td>Inhibitory concentration of EGF dependent auto...</td>
<td>B</td>
<td>CHEMBL66879</td>
<td>=</td>
<td>nM</td>
<td>3000000.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (5451, 11)
</pre></div></div>
</div>
<p>We now have a set of <strong>5451</strong> molecule ids with respective IC50 values for our target kinase.</p>



<h3 id="Get-compound-data">Get compound data<a class="headerlink" href="#Get-compound-data" title="Permalink to this headline">¶</a></h3>
<p>We have a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> containing all molecules tested against EGFR (with the respective measured bioactivity).</p>
<p>Now, we want to get the molecular structures of the molecules that are linked to respective bioactivity ChEMBL IDs.</p>

<h4 id="Fetch-compound-data-from-ChEMBL">Fetch compound data from ChEMBL<a class="headerlink" href="#Fetch-compound-data-from-ChEMBL" title="Permalink to this headline">¶</a></h4>
<p>Let’s have a look at the compounds from ChEMBL which we have defined bioactivity data for: We fetch compound ChEMBL IDs and structures for the compounds linked to our filtered bioactivity data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">compounds</span> <span class="o">=</span> <span class="n">compounds_api</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">molecule_chembl_id__in</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">bioactivities_df</span><span class="p">[</span><span class="s2">"molecule_chembl_id"</span><span class="p">])</span>
<span class="p">)</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s2">"molecule_chembl_id"</span><span class="p">,</span> <span class="s2">"molecule_structures"</span><span class="p">)</span>
</pre></div>
</div>
</div>


<h4 id="Download-compound-data-from-ChEMBL">Download compound data from ChEMBL<a class="headerlink" href="#Download-compound-data-from-ChEMBL" title="Permalink to this headline">¶</a></h4>
<p>Again, we download the <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> in the form of a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. <strong>This may take some time.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">compounds_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">compounds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">compounds_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (5452, 2)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">compounds_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>molecule_chembl_id</th>
<th>molecule_structures</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL6246</td>
<td>{'canonical_smiles': 'O=c1oc2c(O)c(O)cc3c(=O)o...</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL6246</td>
<td>{'canonical_smiles': 'O=c1oc2c(O)c(O)cc3c(=O)o...</td>
</tr>
<tr>
<th>2</th>
<td>CHEMBL10</td>
<td>{'canonical_smiles': 'C[S+]([O-])c1ccc(-c2nc(-...</td>
</tr>
<tr>
<th>3</th>
<td>CHEMBL6976</td>
<td>{'canonical_smiles': 'COc1cc2c(cc1OC)Nc1ncn(C)...</td>
</tr>
<tr>
<th>4</th>
<td>CHEMBL7002</td>
<td>{'canonical_smiles': 'CC1(COc2ccc(CC3SC(=O)NC3...</td>
</tr>
</tbody>
</table>
</div></div>
</div>


<h4 id="Preprocess-and-filter-compound-data">Preprocess and filter compound data<a class="headerlink" href="#Preprocess-and-filter-compound-data" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>Remove entries with missing entries</p></li>
<li><p>Delete duplicate molecules (by molecule_chembl_id)</p></li>
<li><p>Get molecules with canonical SMILES</p></li>
</ol>
<p><strong>1. Remove entries with missing molecule structure entry</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">compounds_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"any"</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">compounds_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (5445, 2)
</pre></div></div>
</div>
<p><strong>2. Delete duplicate molecules</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">compounds_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s2">"molecule_chembl_id"</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s2">"first"</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">compounds_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (5444, 2)
</pre></div></div>
</div>
<p><strong>3. Get molecules with canonical SMILES</strong></p>
<p>So far, we have multiple different molecular structure representations. We only want to keep the canonical SMILES.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">compounds_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">molecule_structures</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys(['canonical_smiles', 'molfile', 'standard_inchi', 'standard_inchi_key'])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">canonical_smiles</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">compounds</span> <span class="ow">in</span> <span class="n">compounds_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">canonical_smiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compounds</span><span class="p">[</span><span class="s2">"molecule_structures"</span><span class="p">][</span><span class="s2">"canonical_smiles"</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">canonical_smiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">compounds_df</span><span class="p">[</span><span class="s2">"smiles"</span><span class="p">]</span> <span class="o">=</span> <span class="n">canonical_smiles</span>
<span class="n">compounds_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"molecule_structures"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">compounds_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (5444, 2)
</pre></div></div>
</div>
<p>Sanity check: Remove all molecules without a canonical SMILES string.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">compounds_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"any"</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">compounds_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (5444, 2)
</pre></div></div>
</div>
<p>We now have a set of <strong>5444</strong> molecule ids with respective IC50 values for our target kinase.</p>



<h3 id="Output-(bioactivity-compound)-data">Output (bioactivity-compound) data<a class="headerlink" href="#Output-(bioactivity-compound)-data" title="Permalink to this headline">¶</a></h3>
<p><strong>Summary of compound and bioactivity data</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Bioactivities filtered: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">bioactivities_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Bioactivities filtered: 5451
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index(['activity_id', 'assay_chembl_id', 'assay_description', 'assay_type',
       'molecule_chembl_id', 'relation', 'units', 'IC50', 'target_chembl_id',
       'target_organism', 'type'],
      dtype='object')
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Compounds filtered: </span><span class="si">{</span><span class="n">compounds_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">compounds_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Compounds filtered: 5444
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index(['molecule_chembl_id', 'smiles'], dtype='object')
</pre></div></div>
</div>

<h4 id="Merge-both-datasets">Merge both datasets<a class="headerlink" href="#Merge-both-datasets" title="Permalink to this headline">¶</a></h4>
<p>Merge values of interest from <code class="docutils literal notranslate"><span class="pre">bioactivities_df</span></code> and <code class="docutils literal notranslate"><span class="pre">compounds_df</span></code> in an <code class="docutils literal notranslate"><span class="pre">output_df</span></code> based on the compounds’ ChEMBL IDs (<code class="docutils literal notranslate"><span class="pre">molecule_chembl_id</span></code>), keeping the following columns:</p>
<ul class="simple">
<li><p>ChEMBL IDs: <code class="docutils literal notranslate"><span class="pre">molecule_chembl_id</span></code></p></li>
<li><p>SMILES: <code class="docutils literal notranslate"><span class="pre">smiles</span></code></p></li>
<li><p>units: <code class="docutils literal notranslate"><span class="pre">units</span></code></p></li>
<li><p>IC50: <code class="docutils literal notranslate"><span class="pre">IC50</span></code></p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Merge DataFrames</span>
<span class="n">output_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">bioactivities_df</span><span class="p">[[</span><span class="s2">"molecule_chembl_id"</span><span class="p">,</span> <span class="s2">"IC50"</span><span class="p">,</span> <span class="s2">"units"</span><span class="p">]],</span>
    <span class="n">compounds_df</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">"molecule_chembl_id"</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Reset row indices</span>
<span class="n">output_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Dataset with </span><span class="si">{</span><span class="n">output_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> entries."</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dataset with 5444 entries.
</pre></div></div>
</div>
<p>Sanity check: The merged bioactivities/compound data set contains <strong>5444</strong> entries.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">output_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
molecule_chembl_id     object
IC50                  float64
units                  object
smiles                 object
dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>molecule_chembl_id</th>
<th>IC50</th>
<th>units</th>
<th>smiles</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL68920</td>
<td>41.0</td>
<td>nM</td>
<td>Cc1cc(C)c(/C=C2\C(=O)Nc3ncnc(Nc4ccc(F)c(Cl)c4)...</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL69960</td>
<td>170.0</td>
<td>nM</td>
<td>Cc1cc(C(=O)N2CCOCC2)[nH]c1/C=C1\C(=O)Nc2ncnc(N...</td>
</tr>
<tr>
<th>2</th>
<td>CHEMBL137635</td>
<td>9300.0</td>
<td>nM</td>
<td>CN(c1ccccc1)c1ncnc2ccc(N/N=N/Cc3ccccn3)cc12</td>
</tr>
<tr>
<th>3</th>
<td>CHEMBL306988</td>
<td>500000.0</td>
<td>nM</td>
<td>CC(=C(C#N)C#N)c1ccc(NC(=O)CCC(=O)O)cc1</td>
</tr>
<tr>
<th>4</th>
<td>CHEMBL66879</td>
<td>3000000.0</td>
<td>nM</td>
<td>O=C(O)/C=C/c1ccc(O)cc1</td>
</tr>
<tr>
<th>5</th>
<td>CHEMBL77085</td>
<td>96000.0</td>
<td>nM</td>
<td>N#CC(C#N)=Cc1cc(O)ccc1[N+](=O)[O-]</td>
</tr>
<tr>
<th>6</th>
<td>CHEMBL443268</td>
<td>5310.0</td>
<td>nM</td>
<td>Cc1cc(C(=O)NCCN2CCOCC2)[nH]c1/C=C1\C(=O)N(C)c2...</td>
</tr>
<tr>
<th>7</th>
<td>CHEMBL76979</td>
<td>264000.0</td>
<td>nM</td>
<td>COc1cc(/C=C(\C#N)C(=O)O)cc(OC)c1O</td>
</tr>
<tr>
<th>8</th>
<td>CHEMBL76589</td>
<td>125.0</td>
<td>nM</td>
<td>N#CC(C#N)=C(N)/C(C#N)=C/c1ccc(O)cc1</td>
</tr>
<tr>
<th>9</th>
<td>CHEMBL76904</td>
<td>35000.0</td>
<td>nM</td>
<td>N#CC(C#N)=Cc1ccc(O)c(O)c1</td>
</tr>
</tbody>
</table>
</div></div>
</div>


<h4 id="Add-pIC50-values">Add pIC50 values<a class="headerlink" href="#Add-pIC50-values" title="Permalink to this headline">¶</a></h4>
<p>As you can see the low IC50 values are difficult to read (values are distributed over multiple scales), which is why we convert the IC50 values to pIC50.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">convert_ic50_to_pic50</span><span class="p">(</span><span class="n">IC50_value</span><span class="p">):</span>
    <span class="n">pIC50_value</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">IC50_value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pIC50_value</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Apply conversion to each row of the compounds DataFrame</span>
<span class="n">output_df</span><span class="p">[</span><span class="s2">"pIC50"</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_ic50_to_pic50</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">IC50</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>molecule_chembl_id</th>
<th>IC50</th>
<th>units</th>
<th>smiles</th>
<th>pIC50</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL68920</td>
<td>41.0</td>
<td>nM</td>
<td>Cc1cc(C)c(/C=C2\C(=O)Nc3ncnc(Nc4ccc(F)c(Cl)c4)...</td>
<td>7.387216</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL69960</td>
<td>170.0</td>
<td>nM</td>
<td>Cc1cc(C(=O)N2CCOCC2)[nH]c1/C=C1\C(=O)Nc2ncnc(N...</td>
<td>6.769551</td>
</tr>
<tr>
<th>2</th>
<td>CHEMBL137635</td>
<td>9300.0</td>
<td>nM</td>
<td>CN(c1ccccc1)c1ncnc2ccc(N/N=N/Cc3ccccn3)cc12</td>
<td>5.031517</td>
</tr>
<tr>
<th>3</th>
<td>CHEMBL306988</td>
<td>500000.0</td>
<td>nM</td>
<td>CC(=C(C#N)C#N)c1ccc(NC(=O)CCC(=O)O)cc1</td>
<td>3.301030</td>
</tr>
<tr>
<th>4</th>
<td>CHEMBL66879</td>
<td>3000000.0</td>
<td>nM</td>
<td>O=C(O)/C=C/c1ccc(O)cc1</td>
<td>2.522879</td>
</tr>
</tbody>
</table>
</div></div>
</div>


<h4 id="Draw-compound-data">Draw compound data<a class="headerlink" href="#Draw-compound-data" title="Permalink to this headline">¶</a></h4>
<p>Let’s have a look at our collected data set.</p>
<p>First, we plot the pIC50 value distribution</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">output_df</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">"pIC50"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Matplotlib created a temporary config/cache directory at /tmp/matplotlib-7xhr_mbj because the default path (/home/andrea/.cache/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[&lt;AxesSubplot:title={'center':'pIC50'}&gt;]], dtype=object)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T001_query_chembl_98_2.png" src="../_images/talktorials_T001_query_chembl_98_2.png"/>
</div>
</div>
<p>In the next steps, we add a column for RDKit molecule objects to our <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and look at the structures of the molecules with the highest pIC50 values.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Add molecule column</span>
<span class="n">PandasTools</span><span class="o">.</span><span class="n">AddMoleculeColumnToFrame</span><span class="p">(</span><span class="n">output_df</span><span class="p">,</span> <span class="n">smilesCol</span><span class="o">=</span><span class="s2">"smiles"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Sort molecules by pIC50</span>
<span class="n">output_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">"pIC50"</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Reset index</span>
<span class="n">output_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Show the three most active molecules, i.e. molecules with the highest pIC50 values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">output_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"smiles"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>molecule_chembl_id</th>
<th>IC50</th>
<th>units</th>
<th>pIC50</th>
<th>ROMol</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL63786</td>
<td>0.003</td>
<td>nM</td>
<td>11.522879</td>
<td><img alt="Mol" data-content="rdkit/molecule" src="data:image/png;base64,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JCcn+/r68tzuNZMnCOvK6YMPsjKUOX/9Y/i0+1np5umTOObNw/Tp1da6QqHo0KHD9evXExISEhISTLbj4ODg4OAQERHB1VYzqUpYXoE9vAJ76C+beLUT3x+x6LMmVwu3bt3avHlzQUHBnDlz2rZtW1hYqNFoAOh0ury8PH7PY2daPFMyysK2nJ2dv/nmm+qKZTKU6n4Wm5vLl1m/fkxYXpaqGDhwIGrwOk5eap2wNm1iAGvWjInJy1Ip+qTit2/fNmvD1YRFdY+Y5mbUKAQG4vZtrFxpvkY1Gg1PabRgwQL+Xt1nn+pWdjVw7BgDmJMTkzsvS6XMmzcPcicVr+HURmExxoKDGcDCwszRVmpqKg/akT2peE2mlgorKUmffVR4W0OHjgLw1ltvCW+pJlFLhcXK/JJFh7T88gtzcbnXq9cHsudDq+HIk23maSQ7G15eUKlw6hSk5WWpFLUavr64eROrV6MGb5ILodatCvW4uWH6dLRte3rVqvcEfbrCw3HzJvz8MHGiCPM1mto7YgHIz9e0bv18Zmbmtm3b+JsdZeT6dfj5QaPB778jKEhe208BtXfEAuDoaMvzXM6aNYufrsjIlCkoKsLYsbVRVajlIxYArVbr7++fmJi4fPly/iolztq1a//666/y/gX29q6lpcOtrODk9PAeJyc89xzatHmM2d278cYbcHHB1ato2FD4b1ETqd61Q01g//79eORFQDzXbXmaNOkEsApfkyY9xmBBAWvRggEsMtJ8v0VN4ylzBBVBcHBwr169oqOjFy1axN8aDCAsLCwzM1P/VmaVSmVj06SwECUlKMsKC6USvr6PMRgRgdRUdOyIsvc110Zq+6OQc+HChYCAAJ7IumXLlhKtlZRg5Ur84x/o1EmW3j2dVPeQWVPg718YOHAgT2yXkZGhz3ZnSHRuVBRzc2P37zNWfa7PNQoasR6Snp7u7e1dp06dnJycx97QuvWb6ek7eOJthQJlOYhRpw5sbBASgvR01K+PpUurJ1ijpkFzrId4eHhcvnx55syZcXFxAB7NmmxpaVdUhKKih/fn5v5f9R49qt+nvkZBI5YRqNUPhaXTocyXGPn5KCnBjRvIysKbb2L6dCiVNGLRiGUM9vbQv8Gpgsf53bvIyqpmn/oaBY1YhBBq9ZEOIQ4SFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiEEEhYhBBIWIQQSFiGE/wH1LPYFoyvpMgAAAABJRU5ErkJggg=="/></td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL35820</td>
<td>0.006</td>
<td>nM</td>
<td>11.221849</td>
<td><img alt="Mol" data-content="rdkit/molecule" src="data:image/png;base64,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"/></td>
</tr>
<tr>
<th>2</th>
<td>CHEMBL53711</td>
<td>0.006</td>
<td>nM</td>
<td>11.221849</td>
<td><img alt="Mol" data-content="rdkit/molecule" src="data:image/png;base64,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"/></td>
</tr>
</tbody>
</table>
</div></div>
</div>


<h4 id="Write-output-data-to-file">Write output data to file<a class="headerlink" href="#Write-output-data-to-file" title="Permalink to this headline">¶</a></h4>
<p>We want to use this bioactivity-compound dataset in the following talktorials, thus we save the data as <code class="docutils literal notranslate"><span class="pre">csv</span></code> file. Note that it is advisable to drop the molecule column (which only contains an image of the molecules) when saving the data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">output_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"ROMol"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">DATA</span> <span class="o">/</span> <span class="s2">"EGFR_compounds.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">output_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (5444, 6)
</pre></div></div>
</div>




<h2 id="Discussion">Discussion<a class="headerlink" href="#Discussion" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial, we collected bioactivity data for our target of interest from the ChEMBL database. We filtered the data set in order to only contain molecules with measured IC50 bioactivity values.</p>
<p>Be aware that ChEMBL data originates from various sources. Compound data has been generated in different labs by different people all over the world. Therefore, we have to be cautious with the predictions we make using this data set. It is always important to consider the source of the data and consistency of data production assays when interpreting the results and determining how much confidence we have in our predictions.</p>
<p>In the next tutorials, we will filter our acquired data by Lipinski’s rule of five and by unwanted substructures. Another important step would be to <em>clean</em> the molecular data. As this is not shown in any of our talktorials (yet), we would like to refer to the <a class="reference external" href="https://github.com/flatkinson/standardiser">Standardiser library</a> or <a class="reference external" href="https://molvs.readthedocs.io/en/latest/">MolVS</a> as useful tools for this task.</p>


<h2 id="Quiz">Quiz<a class="headerlink" href="#Quiz" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>We have downloaded in this talktorial molecules and bioactivity data from ChEMBL. What else is the ChEMBL database useful for?</p></li>
<li><p>What is the difference between IC50 and EC50?</p></li>
<li><p>What can we use the data extracted from ChEMBL for?</p></li>
</ul>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script>



          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../talktorials.html" title="Talktorials by collection"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Talktorials by collection </span>
              </div>
            </a>
          
          
            <a href="T002_compound_adme.html" title="T002 · Molecular filtering: ADME and lead-likeness criteria"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> T002 · Molecular filtering: ADME and lead-likeness criteria </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2018-2021, Volkamer Lab. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.1.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.5.1.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>